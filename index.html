<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live Wedstrijd Tracker</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f0f0f;
  color: #fff;
  margin: 0;
  padding: 12px;
}

h1 {
  text-align: center;
  margin-bottom: 20px;
}

.match {
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 14px;
}

.green { background: #1f7a44; }
.red { background: #8c1d18; }
.neutral { background: #333; }

.teams {
  font-size: 18px;
  font-weight: bold;
}

.scenario {
  font-size: 14px;
  opacity: 0.9;
  margin-top: 4px;
}

.score {
  font-size: 16px;
  margin-top: 10px;
}

.status {
  font-size: 13px;
  opacity: 0.8;
  margin-top: 4px;
}
</style>
</head>

<body>
<h1>Live Scenario Tracker</h1>
<div id="matches"></div>

<script>
const API_KEY = "76505b8dd065466bad41dc42d86f9192";

// Automatische datum van vandaag
const today = new Date().toISOString().split("T")[0];
const API_URL = `https://api.football-data.org/v4/matches?dateFrom=${today}&dateTo=${today}`;

const scenarios = [
  { home: "PSV", away: "Bayern Munich", type: "lose", team: "PSV" },
  { home: "Athletic Club", away: "Sporting CP", type: "lose", team: "Athletic Club" },
  { home: "Napoli", away: "Chelsea FC", type: "lose", team: "Napoli" },
  { home: "FC Copenhagen", away: "FC Barcelona", type: "lose", team: "FC Copenhagen" },
  { home: "Club Brugge", away: "Olympique Marseille", type: "notWin", team: "Club Brugge" },
  { home: "Bodø/Glimt", away: "Atletico Madrid", type: "notWin", team: "Bodø/Glimt" },
  { home: "SL Benfica", away: "Real Madrid", type: "notWin", team: "SL Benfica" },
  { home: "Pafos FC", away: "Slavia Prague", type: "notWin", team: "Pafos FC" },
  { home: "Union Saint-Gilloise", away: "Atalanta", type: "notWin", team: "Union Saint-Gilloise" }
];

async function loadMatches() {
  const res = await fetch(API_URL, {
    headers: { "X-Auth-Token": API_KEY }
  });
  const data = await res.json();
  const container = document.getElementById("matches");
  container.innerHTML = "";

  scenarios.forEach(s => {
    const match = data.matches.find(m =>
      m.homeTeam.name === s.home &&
      m.awayTeam.name === s.away
    );
    if (!match) return;

    const homeGoals = match.score.fullTime.home;
    const awayGoals = match.score.fullTime.away;

    let statusText = "Nog niet gestart";
    let className = "neutral";

    if (homeGoals !== null && awayGoals !== null) {
      let teamGoals, oppGoals;
      if (s.team === match.homeTeam.name) {
        teamGoals = homeGoals;
        oppGoals = awayGoals;
      } else {
        teamGoals = awayGoals;
        oppGoals = homeGoals;
      }

      const success =
        s.type === "lose"
          ? teamGoals < oppGoals
          : teamGoals <= oppGoals;

      className = success ? "green" : "red";
      statusText = `Stand: ${homeGoals} – ${awayGoals}`;
    }

    const div = document.createElement("div");
    div.className = `match ${className}`;

    div.innerHTML = `
      <div class="teams">${match.homeTeam.name} – ${match.awayTeam.name}</div>
      <div class="scenario">Scenario: ${s.team} ${s.type === "lose" ? "verliest" : "wint niet"}</div>
      <div class="score">${statusText}</div>
      <div class="status">${match.status}</div>
    `;
    container.appendChild(div);
  });
}

// Functie voor automatische laadtijden
function scheduleRefresh() {
  const now = new Date();
  const firstLoadTime = new Date();
  firstLoadTime.setHours(13,30,0,0); // eerste load om 13:30

  const refreshStartTime = new Date();
  refreshStartTime.setHours(21,0,0,0); // auto-refresh start om 21:00

  // Eerste load
  if (now >= firstLoadTime) {
    loadMatches();
  } else {
    const delay = firstLoadTime - now;
    setTimeout(loadMatches, delay);
  }

  // Auto-refresh pas vanaf 21:00
  if (now >= refreshStartTime) {
    setInterval(loadMatches, 60000);
  } else {
    const delayRefresh = refreshStartTime - now;
    setTimeout(() => {
      loadMatches();
      setInterval(loadMatches, 60000);
    }, delayRefresh);
  }
}

// Start scheduler
scheduleRefresh();
</script>

</body>
</html>
